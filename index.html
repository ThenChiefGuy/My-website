<!DOCTYPE html>
<html>
<head>
    <title>Welcome to My Site</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        .loading { color: blue; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome!</h1>
        <p>Loading your content...</p>
        <div id="status" class="loading">Initializing tracker...</div>
    </div>

    <script>
    async function trackVisitor() {
        const statusEl = document.getElementById('status');
        
        try {
            // Step 1: Get visitor's IP
            statusEl.textContent = "Detecting location...";
            let ip = "Unknown";
            try {
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                ip = (await ipResponse.json()).ip;
            } catch (e) {
                console.log("Couldn't get IP");
            }

            // Step 2: Collect basic device info
            const data = {
                date: new Date().toLocaleString(),
                ip: ip,
                device: navigator.userAgent,
                screen: `${window.screen.width}x${window.screen.height}`,
                page: window.location.href,
                referrer: document.referrer || "Direct visit"
            };

            // Step 3: Prepare email
            statusEl.textContent = "Preparing report...";
            const subject = `New visitor on ${new Date().toLocaleDateString()}`;
            const body = Object.entries(data)
                .map(([key, val]) => `${key}: ${val}`)
                .join("\n\n");

            // Step 4: Send email (opens user's mail client)
            statusEl.textContent = "Finalizing...";
            window.location.href = `mailto:samsung.glaxj3@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Step 5: Continue to site
            setTimeout(() => {
                window.location.href = "/content.html"; // Change to your real page
            }, 2000);

        } catch (error) {
            console.error("Tracking failed:", error);
            // Fail silently and continue
            window.location.href = "/content.html";
        }
    }

    // Start tracking when page loads
    trackVisitor();
    </script>
</body>
</html>
